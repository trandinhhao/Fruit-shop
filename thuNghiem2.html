<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Danh s√°ch s·∫£n ph·∫©m</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container mt-4">
        <div class="row">
            <!-- Danh s√°ch s·∫£n ph·∫©m (B√™n tr√°i) -->
            <div class="col-md-9">
                <div class="row" id="product-list"></div>
            </div>

            <!-- Thanh t√¨m ki·∫øm v√† b·ªô l·ªçc (B√™n ph·∫£i) -->
            <div class="col-md-3">
                <div class="card p-3">
                    <h5 class="text-center">üîç T√¨m ki·∫øm s·∫£n ph·∫©m</h5>

                    <!-- √î t√¨m ki·∫øm -->
                    <div class="mb-3">
                        <input type="text" id="searchInput" class="form-control" placeholder="Nh·∫≠p t√™n s·∫£n ph·∫©m...">
                    </div>

                    <!-- L·ªçc theo lo·∫°i s·∫£n ph·∫©m -->
                    <div class="mb-3">
                        <select id="categoryFilter" class="form-select">
                            <option value="">T·∫•t c·∫£ lo·∫°i</option>
                            <option value="T√°o">T√°o</option>
                            <option value="Cam">Cam</option>
                            <option value="Xo√†i">Xo√†i</option>
                            <option value="Chu·ªëi">Chu·ªëi</option>
                            <option value="D√¢u">D√¢u</option>
                            <option value="S·∫ßu ri√™ng">S·∫ßu ri√™ng</option>
                        </select>
                    </div>

                    <!-- L·ªçc theo kho·∫£ng gi√° -->
                    <div class="mb-3">
                        <input type="number" id="minPriceFilter" class="form-control" placeholder="Gi√° t·ª´ (VND)">
                    </div>
                    <div class="mb-3">
                        <input type="number" id="maxPriceFilter" class="form-control" placeholder="Gi√° ƒë·∫øn (VND)">
                    </div>

                    <!-- N√∫t l·ªçc -->
                    <button class="btn btn-primary w-100" onclick="filterProducts()">L·ªçc</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let products = [];

        // T·∫£i d·ªØ li·ªáu t·ª´ JSON
        async function fetchProducts() {
            try {
                const response = await fetch('products.json');
                products = await response.json();
                renderProducts(products);
            } catch (error) {
                console.error('L·ªói khi t·∫£i s·∫£n ph·∫©m:', error);
            }
        }

        // Hi·ªÉn th·ªã danh s√°ch s·∫£n ph·∫©m
        function renderProducts(products) {
    const productList = document.getElementById("product-list");
    productList.innerHTML = "";

    products.forEach(product => {
        const discountPrice = product.price * (1 - product.discount / 100);
        const productHTML = `
            <div class="col-md-4 mb-4">
                <div class="product border p-3">
                    <a href="product-detail.html?name=${encodeURIComponent(product.name)}" class="img-prod">
                        <img class="img-fluid" src="${product.imageUrl}" alt="${product.name}" 
                             style="height: 200px; width: 100%; object-fit: contain; background-color: #f8f9fa;">
                        <span class="status">${product.discount}%</span>
                    </a>
                    <div class="text-center mt-3">
                        <h5>${product.name}</h5>
                        <p class="text-muted">${product.unit}</p>
                        <p class="price">
                            <span class="text-danger">${discountPrice.toLocaleString()} VND</span>
                            <del class="text-muted ms-2">${product.price.toLocaleString()} VND</del>
                        </p>
                        <a href="product-detail.html?name=${encodeURIComponent(product.name)}" class="btn btn-primary">Xem chi ti·∫øt</a>
                    </div>
                </div>
            </div>
        `;
        productList.innerHTML += productHTML;
    });
}


        // T√¨m ki·∫øm v√† l·ªçc s·∫£n ph·∫©m theo kho·∫£ng gi√°
        function filterProducts() {
            const searchText = document.getElementById("searchInput").value.toLowerCase();
            const selectedCategory = document.getElementById("categoryFilter").value.toLowerCase();
            const minPrice = document.getElementById("minPriceFilter").value;
            const maxPrice = document.getElementById("maxPriceFilter").value;

            const filteredProducts = products.filter(product => {
                const discountPrice = product.price * (1 - product.discount / 100);
                
                const matchesSearch = product.name.toLowerCase().includes(searchText);
                const matchesCategory = selectedCategory ? product.name.toLowerCase().includes(selectedCategory) : true;
                
                const matchesMinPrice = minPrice ? discountPrice >= minPrice : true;
                const matchesMaxPrice = maxPrice ? discountPrice <= maxPrice : true;
                
                return matchesSearch && matchesCategory && matchesMinPrice && matchesMaxPrice;
            });

            renderProducts(filteredProducts);
        }

        // G·ªçi h√†m khi trang t·∫£i xong
        fetchProducts();
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
